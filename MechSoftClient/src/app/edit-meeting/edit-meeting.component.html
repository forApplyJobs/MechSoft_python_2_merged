<div class="container mt-5">
    <h2>Edit Meeting</h2>
    <form [formGroup]="meetingForm" (ngSubmit)="editMeeting()">
        <div class="form-group mb-3">
            <label for="topic" class="form-label">Topic:</label>
            <input type="text" id="topic" formControlName="topic"
                class="form-control">
            <div
                *ngIf="meetingForm.controls['topic'].invalid && meetingForm.controls['topic'].touched"
                class="text-danger">
                Topic is required.
            </div>
        </div>

        <div class="form-group mb-3">
            <label for="date" class="form-label">Date:</label>
            <input type="date" id="date" formControlName="date"
                class="form-control">
            <div
                *ngIf="meetingForm.controls['date'].invalid && meetingForm.controls['date'].touched"
                class="text-danger">
                Date is required.
            </div>
        </div>

        <div class="form-group mb-3">
            <label for="start_time" class="form-label">Start Time:</label>
            <input type="time" id="start_time" formControlName="start_time"
                class="form-control">
            <div
                *ngIf="meetingForm.controls['start_time'].invalid && meetingForm.controls['start_time'].touched"
                class="text-danger">
                Start time is required.
            </div>
        </div>

        <div class="form-group mb-3">
            <label for="end_time" class="form-label">End Time:</label>
            <input type="time" id="end_time" formControlName="end_time"
                class="form-control">
            <div
                *ngIf="meetingForm.controls['end_time'].invalid && meetingForm.controls['end_time'].touched"
                class="text-danger">
                End time is required.
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-md-6">
                <label for="all-users" class="form-label">All Users:</label>
                <ul id="all-users" class="list-group">
                    <li *ngFor="let user of availableUsers"
                        class="list-group-item d-flex justify-content-between align-items-center">
                        {{ user.name }}
                        <button type="button" class="btn btn-primary btn-sm"
                            (click)="addUser(user)">Add</button>
                    </li>
                </ul>
            </div>
            <div class="col-md-6">
                <label for="participants"
                    class="form-label">Participants:</label>
                <ul id="participants" class="list-group">
                    <li *ngFor="let user of selectedUsers"
                        class="list-group-item d-flex justify-content-between align-items-center">
                        {{ user.name }}
                        <button type="button" class="btn btn-danger btn-sm"
                            (click)="removeUser(user)">Remove</button>
                    </li>
                </ul>
            </div>
        </div>

        <div class="form-group mb-3">
            <label for="guests" class="form-label">Guests:</label>
            <div formArrayName="guests">
                <div
                    *ngFor="let guest of meetingForm.get('guests')?.value; let i = index"
                    [formGroupName]="i">
                    <input type="text" formControlName="name"
                        class="form-control mb-2" placeholder="Guest Name"
                        required>
                    <input type="email" formControlName="email"
                        class="form-control mb-2" placeholder="Guest Email"
                        required>
                    <button type="button" class="btn btn-danger"
                        (click)="removeGuest(i)">Remove</button>
                </div>
            </div>
            <button type="button" class="btn btn-secondary mt-3"
                (click)="addGuest()">Add Guest</button>
        </div>

        <input type="hidden" formControlName="owner_id" />

        <button type="submit" class="btn btn-primary">Save</button>
    </form>
</div>
